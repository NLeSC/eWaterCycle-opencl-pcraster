<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>PCRaster LinkOut API: pcrcalc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PCRaster LinkOut API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pcrcalc_8h.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pcrcalc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;pcrdll.h&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pcrcalc.h:</div>
<div class="dyncontent">
<div class="center"><img src="pcrcalc_8h__incl.png" border="0" usemap="#pcrcalc_8h" alt=""/></div>
<map name="pcrcalc_8h" id="pcrcalc_8h">
</map>
</div>
</div>
<p><a href="pcrcalc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacecalc"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecalc.html">calc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab724002a22f3d1baf7a6a4155166602d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#ab724002a22f3d1baf7a6a4155166602d">INCLUDED_PCRDLL</a></td></tr>
<tr class="separator:ab724002a22f3d1baf7a6a4155166602d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ae02affc4b42263cf2aa930077f3267c0"><td class="memItemLeft" align="right" valign="top">typedef struct Pcrcalc&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a></td></tr>
<tr class="separator:ae02affc4b42263cf2aa930077f3267c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc74fa8500d30343fde527fda556dd2"><td class="memItemLeft" align="right" valign="top">typedef void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#afbc74fa8500d30343fde527fda556dd2">DataTransferArray</a> []</td></tr>
<tr class="separator:afbc74fa8500d30343fde527fda556dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a22f3322728d974c7b15dee1f3fd8425c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a22f3322728d974c7b15dee1f3fd8425c">pcr_createScriptFromTextFile</a> (const char *fileName)</td></tr>
<tr class="memdesc:a22f3322728d974c7b15dee1f3fd8425c"><td class="mdescLeft">&#160;</td><td class="mdescRight">create the PcrScript object by supplying a filename of a text script file  <a href="#a22f3322728d974c7b15dee1f3fd8425c">More...</a><br/></td></tr>
<tr class="separator:a22f3322728d974c7b15dee1f3fd8425c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f99ded6ed5aa8a64e3f36c60f745e76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a7f99ded6ed5aa8a64e3f36c60f745e76">pcr_createScriptFromXMLFile</a> (const char *fileName)</td></tr>
<tr class="memdesc:a7f99ded6ed5aa8a64e3f36c60f745e76"><td class="mdescLeft">&#160;</td><td class="mdescRight">create the PcrScript object by supplying a filename of a XML file with the script root element  <a href="#a7f99ded6ed5aa8a64e3f36c60f745e76">More...</a><br/></td></tr>
<tr class="separator:a7f99ded6ed5aa8a64e3f36c60f745e76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38f25747d83edc3fd07e020a88d74977"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a38f25747d83edc3fd07e020a88d74977">pcr_createScriptFromTextString</a> (const char *scriptContents)</td></tr>
<tr class="memdesc:a38f25747d83edc3fd07e020a88d74977"><td class="mdescLeft">&#160;</td><td class="mdescRight">create the PcrScript object by supplying the textual script as string  <a href="#a38f25747d83edc3fd07e020a88d74977">More...</a><br/></td></tr>
<tr class="separator:a38f25747d83edc3fd07e020a88d74977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdea59f214d50874fb22905127ac09c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#abdea59f214d50874fb22905127ac09c6">pcr_createScriptFromXMLString</a> (const char *xmlString)</td></tr>
<tr class="memdesc:abdea59f214d50874fb22905127ac09c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">create the PcrScript object by supplying the XML as a string with the script root element  <a href="#abdea59f214d50874fb22905127ac09c6">More...</a><br/></td></tr>
<tr class="separator:abdea59f214d50874fb22905127ac09c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a514a9ec3d9ade56ecc6b47c2620aceda"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a514a9ec3d9ade56ecc6b47c2620aceda">pcr_destroyScript</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script)</td></tr>
<tr class="memdesc:a514a9ec3d9ade56ecc6b47c2620aceda"><td class="mdescLeft">&#160;</td><td class="mdescRight">clean up PcrScript object  <a href="#a514a9ec3d9ade56ecc6b47c2620aceda">More...</a><br/></td></tr>
<tr class="separator:a514a9ec3d9ade56ecc6b47c2620aceda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eda34df6c30d13450d01b52efcb431f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a7eda34df6c30d13450d01b52efcb431f">pcr_ScriptError</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script)</td></tr>
<tr class="separator:a7eda34df6c30d13450d01b52efcb431f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06d9069e413faa07870f13015c40bded"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a06d9069e413faa07870f13015c40bded">pcr_ScriptErrorMessage</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script)</td></tr>
<tr class="separator:a06d9069e413faa07870f13015c40bded"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c499f17146e41a065c2806b850f240"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a85c499f17146e41a065c2806b850f240">pcr_ScriptXMLReflection</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script)</td></tr>
<tr class="memdesc:a85c499f17146e41a065c2806b850f240"><td class="mdescLeft">&#160;</td><td class="mdescRight">PCRaster script XML document.  <a href="#a85c499f17146e41a065c2806b850f240">More...</a><br/></td></tr>
<tr class="separator:a85c499f17146e41a065c2806b850f240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fe8d8b91735be6311dd52ea89a5dd77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a2fe8d8b91735be6311dd52ea89a5dd77">pcr_ScriptExecute</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script)</td></tr>
<tr class="memdesc:a2fe8d8b91735be6311dd52ea89a5dd77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute entire script.  <a href="#a2fe8d8b91735be6311dd52ea89a5dd77">More...</a><br/></td></tr>
<tr class="separator:a2fe8d8b91735be6311dd52ea89a5dd77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3df23e23d1ef0851b972a009d611e2a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a3df23e23d1ef0851b972a009d611e2a4">pcr_ScriptExecuteInitialStepMemory</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script, <a class="el" href="pcrcalc_8h.html#afbc74fa8500d30343fde527fda556dd2">DataTransferArray</a> dataTransferArray)</td></tr>
<tr class="memdesc:a3df23e23d1ef0851b972a009d611e2a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the initial section only.  <a href="#a3df23e23d1ef0851b972a009d611e2a4">More...</a><br/></td></tr>
<tr class="separator:a3df23e23d1ef0851b972a009d611e2a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194239250189a664352fc2b55bcc41dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a194239250189a664352fc2b55bcc41dd">pcr_ScriptExecuteNextTimeStepMemory</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script, <a class="el" href="pcrcalc_8h.html#afbc74fa8500d30343fde527fda556dd2">DataTransferArray</a> dataTransferArray)</td></tr>
<tr class="memdesc:a194239250189a664352fc2b55bcc41dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a timestep.  <a href="#a194239250189a664352fc2b55bcc41dd">More...</a><br/></td></tr>
<tr class="separator:a194239250189a664352fc2b55bcc41dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9df104fc3ec8b2b1ea215763666ee9bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#a9df104fc3ec8b2b1ea215763666ee9bf">pcr_ScriptExecuteFinish</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script)</td></tr>
<tr class="memdesc:a9df104fc3ec8b2b1ea215763666ee9bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">End execution started with <a class="el" href="pcrcalc_8h.html#a3df23e23d1ef0851b972a009d611e2a4" title="Execute the initial section only.">pcr_ScriptExecuteInitialStepMemory()</a> and <a class="el" href="pcrcalc_8h.html#a194239250189a664352fc2b55bcc41dd" title="Execute a timestep.">pcr_ScriptExecuteNextTimeStepMemory()</a> sequence.  <a href="#a9df104fc3ec8b2b1ea215763666ee9bf">More...</a><br/></td></tr>
<tr class="separator:a9df104fc3ec8b2b1ea215763666ee9bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace1ed8a78808419786156421c788fdc8"><td class="memItemLeft" align="right" valign="top">calc::ASTScript const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcrcalc_8h.html#ace1ed8a78808419786156421c788fdc8">pcr_internalScript</a> (<a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *script)</td></tr>
<tr class="memdesc:ace1ed8a78808419786156421c788fdc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">not part of the API  <a href="#ace1ed8a78808419786156421c788fdc8">More...</a><br/></td></tr>
<tr class="separator:ace1ed8a78808419786156421c788fdc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ab724002a22f3d1baf7a6a4155166602d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INCLUDED_PCRDLL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="pcrcalc_8h_source.html#l00006">6</a> of file <a class="el" href="pcrcalc_8h_source.html">pcrcalc.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="afbc74fa8500d30343fde527fda556dd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void* DataTransferArray[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Both stepwise functions, <a class="el" href="pcrcalc_8h.html#a3df23e23d1ef0851b972a009d611e2a4" title="Execute the initial section only.">pcr_ScriptExecuteInitialStepMemory()</a> and <a class="el" href="pcrcalc_8h.html#a194239250189a664352fc2b55bcc41dd" title="Execute a timestep.">pcr_ScriptExecuteNextTimeStepMemory()</a>, have a dataTransferArray argument used for transferring data. dataTransferArray is a low level interface. The memory layout of DataTransferArray is specified in the script XML document.</p>
<p>dataTransferArray is the address of an array of addresses (in C terms: an array of void pointers). The index in the array is the nominal value presented in the definition/{scriptInput/scriptOutput}/memoryExchange element. The array must have an entry for each memoryExchange element present. If the entry is not 0, then the entry is the address of a transfer buffer.</p>
<p>The semantics of the transfer buffer depends on if the memoryExchange element appears in a scriptInput or scriptOutput element:</p>
<ul>
<li><b>scriptInput</b>: The buffer does contain a value for the item, when the stepwise function is called. The buffer is not modified when the stepwise function returns. An entry may be 0 if the corresponding memoryExchange element is not used in either the initial or dynamic section for which the stepwise function is called. If it used, but 0 is passed a runtime error will occur (see <a class="el" href="pcrcalc_8h.html#a7eda34df6c30d13450d01b52efcb431f">pcr_ScriptError()</a>).</li>
<li><b>scriptOutput</b>: If the buffer is not 0 when the stepwise function is called then the caller has reserved enough space at the buffer address. The stepwise function will copy data into the buffer. If the buffer is 0 the stepwise function will allocate it (see <em>allocation by the function</em> below).</li>
</ul>
<h1><a class="anchor" id="functionAllocation"></a>
Allocation by the Function</h1>
<p>If the buffer is 0 the stepwise function will allocate it. The buffer allocated should not be deleted/freed by the caller nor should the address by passed back in a successive call to a stepwise function. A successive call to a stepwise function or <a class="el" href="pcrcalc_8h.html#a514a9ec3d9ade56ecc6b47c2620aceda" title="clean up PcrScript object">pcr_destroyScript()</a> will delete the buffer. Thus the buffer is only valid until such a next call.</p>
<p><b>Rule</b>: Buffers allocated by the caller should be deleted by the caller. Buffers allocated by the stepwise functions will be deleted by a next stepwise function or <a class="el" href="pcrcalc_8h.html#a514a9ec3d9ade56ecc6b47c2620aceda" title="clean up PcrScript object">pcr_destroyScript()</a> call.</p>
<h1><a class="anchor" id="transferBuffer"></a>
Transfer Buffer layout</h1>
<p>The transfer buffer is either:</p>
<ul>
<li>a field buffer, if the definition element the memoryExchange element is appearing in holds a field element.</li>
<li>an indexedArray buffer, if the definition element the memoryExchange element is appearing in holds an indexedArray element.</li>
<li>a textString buffer if the definition element's name is used in a textStatistics element.</li>
<li>a timeoutputRow buffer if the definition element's name is assigned the result of a timeoutput function in the model.</li>
</ul>
<h2><a class="anchor" id="fieldBufferMemoryLayout"></a>
Field Buffer Memory Layout</h2>
<p>A field buffer consist of one the following elementary types:</p>
<ul>
<li>unsigned char (UINT1): 8-bit byte for Boolean and Ldd.</li>
<li>int (INT4): 32 bit integer for Nominal and Ordinal.</li>
<li>float (REAL4): 32 bit float for Scalar and Directional.</li>
</ul>
<p>The field buffer is either:</p>
<ul>
<li>a single value if the definition element contains the spatialType element with the value NonSpatial</li>
<li>an array of size areaMap/nrRows * areaMap/nrCols if the field definition element contains the spatialType element with the value Spatial</li>
</ul>
<h2><a class="anchor" id="indexedArrayBufferMemoryLayout"></a>
IndexedArray Buffer Memory Layout</h2>
<p>An indexedArray buffer consists of two parts: a header followed by the data.</p>
<p>The header consists of 1+NDIM values of the type specified in the indexedArray/dimensionDataType element. The first value of the header represent the number of dimensions (NDIM). Successive values will give the length of each dimension.</p>
<p>The data consists of X values of the type specified in the indexedArray/valueDataType. X is the multiplication of all dimension lengths.</p>
<p>Currently only a 1 dimensional array is needed to use the lookup... functions with an indexedArray element. For example an array of 1 by 3 with the array values 1.33, 2.33 and 3.33 will have the following layout: </p>
<pre class="fragment">   1    # number of dimensions
   3    # length of dimension 1
   1.33
   2.33
   3.33</pre><h2><a class="anchor" id="textStringMemoryLayout"></a>
textString Buffer Memory Layout</h2>
<p>A 0-terminated ANSI character string. Since the buffer is of unknown length upon calling it is recommended to let the function allocate this buffer (pass 0 in, get address out).</p>
<h2><a class="anchor" id="timeoutputRowLayout"></a>
timeoutput Buffer Memory Layout</h2>
<p>In essence this a 1 dimensional array of values as they would appear on a row of a pcrcalc timeoutput tss file, with the time column removed.</p>
<p>The memory buffer does however prepend a header of 4 unsigned integers (INT4):</p>
<ul>
<li>0. Always holds value 1 (to allow other versions in the future).</li>
<li>1. Constant (matching the CSF_CR enum of the PCRaster file format API) identifying the type of the row entries:<ul>
<li>0 (0x00) for UINT1 (unsigned char)</li>
<li>38 (0x26) for INT4 (signed int)</li>
<li>90 (0x5A) for REAL4 (float)</li>
</ul>
</li>
<li>2. Always holds value 1 (the number of dimensions of this buffer).</li>
<li>3. The number of entries following (length of dimension 1).</li>
</ul>
<p>After the header the row entries will follow which are of the type identified by header item 1 and the number of entries by header item 3.</p>
<p>Since the buffer is of unknown length upon calling it is recommended to let the function allocate this buffer (pass 0 in, get address out). </p>

<p>Definition at line <a class="el" href="pcrcalc_8h_source.html#l00127">127</a> of file <a class="el" href="pcrcalc_8h_source.html">pcrcalc.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae02affc4b42263cf2aa930077f3267c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct Pcrcalc <a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="pcrcalc_8h_source.html#l00032">32</a> of file <a class="el" href="pcrcalc_8h_source.html">pcrcalc.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a22f3322728d974c7b15dee1f3fd8425c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_createScriptFromTextFile </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>create the PcrScript object by supplying a filename of a text script file </p>
<p>pcr_createScriptFromTextFile allocates some internal memory to set up error handling. No other actions, such as checking if the fileName exists or the script has a valid syntax, are taken here. All these actions are deferred to a next call that needs the script such as <a class="el" href="pcrcalc_8h.html#a2fe8d8b91735be6311dd52ea89a5dd77" title="Execute entire script.">pcr_ScriptExecute()</a> or <a class="el" href="pcrcalc_8h.html#a85c499f17146e41a065c2806b850f240" title="PCRaster script XML document.">pcr_ScriptXMLReflection()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>C-string (Ansi 1-byte char set) with name of script file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a38f25747d83edc3fd07e020a88d74977"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_createScriptFromTextString </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>scriptContents</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>create the PcrScript object by supplying the textual script as string </p>
<p>pcr_createScriptFromTextFile allocates some internal memory to set up error handling. No other actions, such as checking if the script has a valid syntax, are taken here. Al these actions are deferred to a next call that needs the script such as <a class="el" href="pcrcalc_8h.html#a2fe8d8b91735be6311dd52ea89a5dd77" title="Execute entire script.">pcr_ScriptExecute()</a> or <a class="el" href="pcrcalc_8h.html#a85c499f17146e41a065c2806b850f240" title="PCRaster script XML document.">pcr_ScriptXMLReflection()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scriptContents</td><td>C-string (Ansi 1-byte char set) with script contents </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7f99ded6ed5aa8a64e3f36c60f745e76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_createScriptFromXMLFile </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>create the PcrScript object by supplying a filename of a XML file with the script root element </p>
<p>pcr_createScriptFromXMLFile allocates some internal memory to set up error handling. No other actions, such as checking if the file exists or the script has a valid syntax, are taken here. All these actions are deferred to a next call that needs the script such as <a class="el" href="pcrcalc_8h.html#a2fe8d8b91735be6311dd52ea89a5dd77" title="Execute entire script.">pcr_ScriptExecute()</a> or <a class="el" href="pcrcalc_8h.html#a85c499f17146e41a065c2806b850f240" title="PCRaster script XML document.">pcr_ScriptXMLReflection()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>C-string (Ansi 1-byte char set) with name of script file </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abdea59f214d50874fb22905127ac09c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_createScriptFromXMLString </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>xmlString</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>create the PcrScript object by supplying the XML as a string with the script root element </p>
<p>pcr_createScriptFromXMLString allocates some internal memory to set up error handling. No other actions, such as checking if the script has a valid syntax, are taken here. Al these actions are deferred to a next call that needs the script such as <a class="el" href="pcrcalc_8h.html#a2fe8d8b91735be6311dd52ea89a5dd77" title="Execute entire script.">pcr_ScriptExecute()</a> or <a class="el" href="pcrcalc_8h.html#a85c499f17146e41a065c2806b850f240" title="PCRaster script XML document.">pcr_ScriptXMLReflection()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xmlString</td><td>C-string (Ansi 1-byte char set) with script contents </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a514a9ec3d9ade56ecc6b47c2620aceda"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_destroyScript </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>clean up PcrScript object </p>
<p>cleans up all dynamic data kept for <em>script</em> </p>

</div>
</div>
<a class="anchor" id="ace1ed8a78808419786156421c788fdc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">calc::ASTScript const&amp; pcr_internalScript </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>not part of the API </p>

</div>
</div>
<a class="anchor" id="a7eda34df6c30d13450d01b52efcb431f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_ScriptError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>check if an error has occured </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script</td><td>the script object</td></tr>
  </table>
  </dd>
</dl>
<p>Read <a class="el" href="index.html#errorHandling">Error Handling</a> on how errors are handled.</p>
<dl class="section return"><dt>Returns</dt><dd>0 if no error present for <em>script</em>, otherwise the size of the string (excl. terminating 0) returned by <a class="el" href="pcrcalc_8h.html#a06d9069e413faa07870f13015c40bded">pcr_ScriptErrorMessage()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a06d9069e413faa07870f13015c40bded"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_ScriptErrorMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>get error message </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script</td><td>the script object</td></tr>
  </table>
  </dd>
</dl>
<p>Read <a class="el" href="index.html#errorHandling">Error Handling</a> on how errors are handled.</p>
<dl class="section return"><dt>Returns</dt><dd>a C-string (Ansi 1-byte char set), empty string if no error present for <em>script</em>, otherwise the error message. </dd></dl>

</div>
</div>
<a class="anchor" id="a2fe8d8b91735be6311dd52ea89a5dd77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_ScriptExecute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute entire script. </p>
<p>This execute variant expects all data to present as files on the filesystem, in contrast to the <a class="el" href="pcrcalc_8h.html#a3df23e23d1ef0851b972a009d611e2a4" title="Execute the initial section only.">pcr_ScriptExecuteInitialStepMemory()</a> and <a class="el" href="pcrcalc_8h.html#a194239250189a664352fc2b55bcc41dd" title="Execute a timestep.">pcr_ScriptExecuteNextTimeStepMemory()</a> setup. </p>

</div>
</div>
<a class="anchor" id="a9df104fc3ec8b2b1ea215763666ee9bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_ScriptExecuteFinish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>End execution started with <a class="el" href="pcrcalc_8h.html#a3df23e23d1ef0851b972a009d611e2a4" title="Execute the initial section only.">pcr_ScriptExecuteInitialStepMemory()</a> and <a class="el" href="pcrcalc_8h.html#a194239250189a664352fc2b55bcc41dd" title="Execute a timestep.">pcr_ScriptExecuteNextTimeStepMemory()</a> sequence. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script</td><td>the script object</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>-1 finishing raised an error, check <a class="el" href="pcrcalc_8h.html#a06d9069e413faa07870f13015c40bded">pcr_ScriptErrorMessage(PcrScript *script)</a></li>
<li>0 finished with no error</li>
</ul>
<a class="el" href="pcrcalc_8h.html#a514a9ec3d9ade56ecc6b47c2620aceda" title="clean up PcrScript object">pcr_destroyScript()</a> will perform the same actions but <a class="el" href="pcrcalc_8h.html#a514a9ec3d9ade56ecc6b47c2620aceda" title="clean up PcrScript object">pcr_destroyScript()</a> can not return an error message. Only needed if caller wants to terminate before end of model or if model does not know the number of timesteps itself. </dd></dl>

</div>
</div>
<a class="anchor" id="a3df23e23d1ef0851b972a009d611e2a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_ScriptExecuteInitialStepMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#afbc74fa8500d30343fde527fda556dd2">DataTransferArray</a>&#160;</td>
          <td class="paramname"><em>dataTransferArray</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the initial section only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script</td><td>the script object </td></tr>
    <tr><td class="paramname">dataTransferArray</td><td>see DataTransferArray</td></tr>
  </table>
  </dd>
</dl>
<p>If the model is a static model, the entire model is executed. Repetive calls will do nothing; for each script object the initial section can only be called once.</p>
<p>Calling this function more than once will result in an error.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>-1 model terminated in error, check <a class="el" href="pcrcalc_8h.html#a06d9069e413faa07870f13015c40bded">pcr_ScriptErrorMessage(PcrScript *script)</a></li>
<li>0 initial step is executed, model finished thus it is a static model.</li>
<li>1 initial step is executed, model not yet finished, thus it is a dynamic model.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The function will not put an output into <em>dataTransferArray</em> if that output is also re-computed in the dynamic section: <pre class="fragment">  initial
   # pcr_ScriptExecuteInitialStepMemory will *NOT* put value of out in dataTransferArray
   out = in * 1;
  dynamic
   # pcr_ScriptExecuteNextTimeStepMemory will put value of out in dataTransferArray
   out =  f(out, ...);</pre> This is consistent how pcrcalc deals with output map stacks versus single map output. If you need the initial value use an auxiliary variable (no performance penalty): <pre class="fragment">  initial
   # pcr_ScriptExecuteInitialStepMemory will *NOT* put value of out in dataTransferArray
   out = in * 1;
   # pcr_ScriptExecuteInitialStepMemory cat put this value in dataTransferArray
   staticOut = out;
  dynamic
   # pcr_ScriptExecuteNextTimeStepMemory will put value of out in dataTransferArray
   out =  f(out, ...);</pre> </dd></dl>

</div>
</div>
<a class="anchor" id="a194239250189a664352fc2b55bcc41dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_ScriptExecuteNextTimeStepMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#afbc74fa8500d30343fde527fda556dd2">DataTransferArray</a>&#160;</td>
          <td class="paramname"><em>dataTransferArray</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute a timestep. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script</td><td>the script object </td></tr>
    <tr><td class="paramname">dataTransferArray</td><td>Execute next time step. Calling this function without first calling <a class="el" href="pcrcalc_8h.html#a3df23e23d1ef0851b972a009d611e2a4" title="Execute the initial section only.">pcr_ScriptExecuteInitialStepMemory()</a> will result in an error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>-1 model terminated in error, check <a class="el" href="pcrcalc_8h.html#a06d9069e413faa07870f13015c40bded">pcr_ScriptErrorMessage(PcrScript *script)</a></li>
<li>0 a timestep is executed, model finished; this call executed the last timestep.</li>
<li>1 a timestep is executed, model not yet finished, more steps may follow.</li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a85c499f17146e41a065c2806b850f240"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pcr_ScriptXMLReflection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pcrcalc_8h.html#ae02affc4b42263cf2aa930077f3267c0">PcrScript</a> *&#160;</td>
          <td class="paramname"><em>script</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PCRaster script XML document. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script</td><td>the script object</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 in case of error, C-string (Ansi 1-byte char set) with document otherwise. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="pcrcalc_8h.html">pcrcalc.h</a></li>
    <li class="footer">Generated on Tue Sep 17 2013 14:56:38 for PCRaster LinkOut API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
